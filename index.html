<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AnimePro v1.7 | Portal Ultra</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Oswald:wght@500;700&family=Roboto:wght@400;700&display=swap');
        :root { --primary: #F47521; --bg: #050505; --surface: #121212; --text: #fff; }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Roboto', sans-serif; background: var(--bg); color: var(--text); overflow-x: hidden; }

        /* TELA DE ENTRADA √âPICA */
        #choice-screen {
            height: 100vh; width: 100%; display: flex; flex-direction: column;
            justify-content: center; align-items: center; 
            background: linear-gradient(rgba(0,0,0,0.7), rgba(0,0,0,0.9)), url('https://images.alphacoders.com/605/605156.jpg') center/cover;
            position: fixed; z-index: 9999; text-align: center;
        }
        .choice-container { display: flex; gap: 40px; margin-top: 40px; flex-wrap: wrap; justify-content: center; }
        .choice-card {
            width: 280px; padding: 40px; background: rgba(0,0,0,0.6);
            border: 3px solid var(--primary); border-radius: 20px; cursor: pointer;
            transition: 0.4s; backdrop-filter: blur(10px);
        }
        .choice-card:hover { transform: translateY(-15px); background: var(--primary); box-shadow: 0 0 30px var(--primary); }
        .choice-card h2 { font-family: 'Oswald'; font-size: 2.5rem; }

        /* INTERFACE PRINCIPAL */
        #main-interface { display: none; }
        header { padding: 20px 5%; background: #000; display: flex; justify-content: space-between; align-items: center; border-bottom: 3px solid var(--primary); }
        .logo { font-family: 'Oswald'; font-size: 2.5rem; color: var(--primary); cursor: pointer; }
        
        .grid { display: grid; padding: 30px 5%; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 25px; }
        .card { background: var(--surface); border-radius: 10px; overflow: hidden; cursor: pointer; border: 1px solid #333; transition: 0.3s; }
        .card:hover { border-color: var(--primary); transform: scale(1.05); }
        .card img { width: 100%; height: 260px; object-fit: cover; }

        /* MODAL ATUALIZADO */
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.98); z-index: 2000; overflow-y: auto; }
        .modal-content { max-width: 900px; margin: 50px auto; background: #111; padding: 30px; border-radius: 15px; border: 1px solid #444; }
        
        .player-info { display: flex; gap: 15px; margin: 20px 0; flex-wrap: wrap; }
        select { flex: 1; padding: 12px; background: #222; color: #fff; border: 1px solid var(--primary); border-radius: 5px; cursor: pointer; }
        
        .btn-play { 
            display: block; width: 100%; padding: 20px; background: var(--primary); 
            color: #fff; text-align: center; text-decoration: none; font-weight: bold; 
            font-size: 1.2rem; border-radius: 10px; margin: 20px 0; transition: 0.3s;
        }
        .btn-play:hover { background: #ff8c00; transform: scale(1.02); }

        .ep-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(60px, 1fr)); gap: 10px; margin-top: 20px; }
        .ep-item { background: #333; padding: 15px; text-align: center; cursor: pointer; border-radius: 8px; font-weight: bold; transition: 0.2s; }
        .ep-item:hover, .ep-item.active { background: var(--primary); }
        .close { float: right; font-size: 40px; color: var(--primary); cursor: pointer; line-height: 1; }
    </style>
</head>
<body>

<div id="choice-screen">
    <h1 style="font-family:'Oswald'; font-size: 4rem; text-shadow: 2px 2px 10px #000;">ANIME PRO</h1>
    <p style="font-size: 1.2rem; margin-bottom: 20px;">O universo Otaku na palma da sua m√£o</p>
    <div class="choice-container">
        <div class="choice-card" onclick="entrar('anime')">
            <div style="font-size: 5rem;">üé¨</div>
            <h2>ASSISTIR</h2>
        </div>
        <div class="choice-card" onclick="entrar('manga')">
            <div style="font-size: 5rem;">üìñ</div>
            <h2>LER</h2>
        </div>
    </div>
</div>

<div id="main-interface">
    <header>
        <div class="logo" onclick="location.reload()">ANIME<span>PRO</span></div>
        <input type="text" id="searchInput" placeholder="Buscar no cat√°logo..." oninput="debounceSearch()" style="padding:12px; background:#222; color:#fff; border:1px solid #444; border-radius:30px; width:300px;">
    </header>
    <div class="grid" id="mainGrid"></div>
</div>

<div id="mainModal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeModal()">&times;</span>
        <h2 id="modalTitle" style="font-family:'Oswald'; font-size: 2rem; color: var(--primary);">T√≠tulo</h2>
        
        <div class="player-info">
            <select id="seasonSelect">
                <option value="1">1¬™ Temporada</option>
                <option value="2">2¬™ Temporada</option>
            </select>
            <select id="langSelect">
                <option value="legendado">Legendado</option>
                <option value="dublado">Dublado (Se dispon√≠vel)</option>
            </select>
        </div>

        <p id="selectedEpText" style="text-align:center; color: #aaa;">Selecione um epis√≥dio abaixo:</p>
        <a id="btnAssistir" href="#" target="_blank" class="btn-play" style="display:none;">DAR O PLAY AGORA ‚ñ∂</a>
        
        <div class="ep-grid" id="epGrid"></div>
    </div>
</div>

<script>
    let mode = 'anime';
    let currentItem = null;
    let selectedEp = null;

    function entrar(tipo) {
        mode = tipo;
        document.getElementById('choice-screen').style.opacity = '0';
        setTimeout(() => {
            document.getElementById('choice-screen').style.display = 'none';
            document.getElementById('main-interface').style.display = 'block';
            loadData();
        }, 500);
    }

    async function loadData(query = '') {
        const grid = document.getElementById('mainGrid');
        grid.innerHTML = "<h2 style='grid-column:1/-1; text-align:center;'>Carregando conte√∫do...</h2>";
        let url = `https://api.jikan.moe/v4/${mode === 'anime' ? 'anime' : 'manga'}?order_by=popularity&limit=24`;
        if(query) url += `&q=${query}`;
        
        try {
            const resp = await fetch(url);
            const data = await resp.json();
            grid.innerHTML = data.data.map(item => `
                <div class="card" onclick='openModal(${JSON.stringify(item).replace(/'/g, "&apos;")})'>
                    <img src="${item.images.jpg.large_image_url}">
                    <div style="padding:15px; text-align:center; font-weight:bold;">${item.title}</div>
                </div>
            `).join('');
        } catch(e) { grid.innerHTML = "Erro ao carregar. Tente atualizar a p√°gina."; }
    }

    function openModal(item) {
        currentItem = item;
        selectedEp = null;
        document.getElementById('modalTitle').innerText = item.title;
        document.getElementById('mainModal').style.display = 'block';
        document.getElementById('btnAssistir').style.display = 'none';
        document.getElementById('selectedEpText').innerText = "Selecione um epis√≥dio abaixo:";
        
        const epGrid = document.getElementById('epGrid');
        epGrid.innerHTML = "";
        const total = mode === 'anime' ? (item.episodes || 24) : (item.chapters || 50);

        for(let i=1; i<=total; i++) {
            const div = document.createElement('div');
            div.className = 'ep-item';
            div.innerText = i;
            div.onclick = function() {
                // Remove destaque dos outros e coloca neste
                document.querySelectorAll('.ep-item').forEach(el => el.classList.remove('active'));
                this.classList.add('active');
                prepararPlay(i);
            };
            epGrid.appendChild(div);
        }
    }

    function prepararPlay(num) {
    selectedEp = num;
    const lang = document.getElementById('langSelect').value;
    const id = currentItem.mal_id;
    const title = currentItem.title;
    
    // Configura√ß√£o de m√∫ltiplos servidores paliativos
    const s1 = `https://embedder.net/e/anime/${id}${lang === 'dublado' ? '-dublado' : ''}/${num}`;
    const s2 = `https://supervideo.tv/e/anime/${id}/${num}`; // Servidor Alternativo 1
    const s3 = `https://www.google.com/search?q=assistir+${title.replace(/\s+/g, '+')}+episodio+${num}+${lang}`;

    const btnArea = document.getElementById('epGrid');
    
    // Atualiza a √°rea de a√ß√£o com m√∫ltiplas op√ß√µes de player
    document.getElementById('selectedEpText').innerHTML = `
        <div style="background:#222; padding:15px; border-radius:10px; border:1px solid var(--primary);">
            <p style="margin-bottom:10px;">Epis√≥dio ${num} selecionado!</p>
            <div style="display:flex; flex-direction:column; gap:10px;">
                <a href="${s1}" target="_blank" class="btn-play" style="margin:0; background:#444;">TESTAR SERVIDOR 1 (Embedder)</a>
                <a href="${s2}" target="_blank" class="btn-play" style="margin:0; background:#444;">TESTAR SERVIDOR 2 (SuperVideo)</a>
                <a href="${s3}" target="_blank" class="btn-play" style="margin:0; background:var(--primary);">BUSCA EXTERNA (Google)</a>
            </div>
            <p style="font-size:11px; color:orange; margin-top:10px;">Nota: Se o Servidor 1 der "Web server is down", use as outras op√ß√µes.</p>
        </div>
    `;
}
    function closeModal() { document.getElementById('mainModal').style.display = 'none'; }

    function debounceSearch() {
        clearTimeout(window.searchTimer);
        window.searchTimer = setTimeout(() => loadData(document.getElementById('searchInput').value), 800);
    }
</script>
</body>
</html>